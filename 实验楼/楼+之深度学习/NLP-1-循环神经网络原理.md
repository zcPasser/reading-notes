[TOC]

# ä»‹ç»

> NLPæœ€ä¸ºå¸¸ç”¨çš„**æ·±åº¦ç¥ç»ç½‘ç»œç±»å‹**ï¼šå¾ªç¯ç¥ç»ç½‘ç»œã€‚

## å…³ç³»

![](D:\äº‹åŠ¡\æˆ‘çš„äº‹åŠ¡\æ‹“å±•å­¦ä¹ \ç¬”è®°\pictures\æ¥¼+æ·±åº¦å­¦ä¹ \NLP\NLP-ML-DL-AIå…³ç³».jpg)

## NLPç»„æˆ

### è‡ªç„¶è¯­è¨€ç†è§£NLU

- 3ä¸ªæ–¹é¢

1. è¯ä¹‰åˆ†æã€‚
2. å¥æ³•åˆ†æã€‚
3. è¯­ä¹‰åˆ†æã€‚

### è‡ªç„¶è¯­è¨€ç”ŸæˆNLG

> ä»ç»“æ„åŒ–æ•°æ®ï¼ˆNLUåˆ†æåçš„æ•°æ®ï¼‰ä»¥è¯»å–æ–¹å¼è‡ªåŠ¨ç”Ÿæˆæ–‡æœ¬ã€‚

- 3ä¸ªé˜¶æ®µ

1. æ–‡æœ¬è§„åˆ’ï¼šå®Œæˆç»“æ„åŒ–æ•°æ®ä¸­çš„åŸºç¡€å†…å®¹è§„åˆ’ã€‚
2. è¯­å¥è§„åˆ’ï¼šä»ç»“æ„åŒ–æ•°æ®ä¸­ç»„åˆè¯­å¥æ¥è¡¨è¾¾ä¿¡æ¯æµã€‚
3. å®ç°ï¼šäº§ç”Ÿè¯­æ³•é€šé¡ºçš„è¯­å¥æ¥è¡¨è¾¾æ–‡æœ¬ã€‚

## NLPåº”ç”¨

- ä¿¡æ¯æ£€ç´¢ï¼šå¯¹å¤§è§„æ¨¡æ–‡æ¡£è¿›è¡Œç´¢å¼•ã€‚
- è¯­éŸ³è¯†åˆ«ï¼šè¯†åˆ«åŒ…å«å£è¯­åœ¨å†…çš„è‡ªç„¶è¯­è¨€çš„å£°å­¦ä¿¡å·è½¬æ¢æˆç¬¦åˆé¢„æœŸçš„ä¿¡å·ã€‚
- æœºå™¨ç¿»è¯‘ï¼šå°†ä¸€ç§è¯­è¨€ç¿»è¯‘æˆå¦å¤–ä¸€ç§è¯­è¨€ã€‚
- æ™ºèƒ½é—®ç­”ï¼šè‡ªåŠ¨å›ç­”é—®é¢˜ã€‚
- å¯¹è¯ç³»ç»Ÿï¼šé€šè¿‡å¤šå›åˆå¯¹è¯ï¼Œè·Ÿç”¨æˆ·è¿›è¡ŒèŠå¤©ã€å›ç­”ã€å®ŒæˆæŸé¡¹ä»»åŠ¡ã€‚
- æ–‡æœ¬åˆ†ç±»ï¼šå°†æ–‡æœ¬è‡ªåŠ¨å½’ç±»ã€‚
- æƒ…æ„Ÿåˆ†æï¼šåˆ¤æ–­æŸæ®µæ–‡æœ¬çš„æƒ…æ„Ÿå€¾å‘
- æ–‡æœ¬ç”Ÿæˆï¼šæ ¹æ®éœ€æ±‚è‡ªåŠ¨ç”Ÿæˆæ–‡æœ¬
- è‡ªåŠ¨æ–‡æ‘˜ï¼šå½’çº³ï¼Œæ€»ç»“æ–‡æœ¬çš„æ‘˜è¦ã€‚

# åºåˆ—æ¨¡å‹

- å«ä¹‰

åºåˆ—æŒ‡è¿™ä¸ªæ¨¡å‹ä¸­çš„**å…ƒç´ ä¸å†ç‹¬ç«‹**ï¼Œè€Œæ˜¯å…·æœ‰**ä¸€å®šçš„ç›¸å…³æ€§**ã€‚

## æ¨¡å‹åˆ†ç±»

![](D:\äº‹åŠ¡\æˆ‘çš„äº‹åŠ¡\æ‹“å±•å­¦ä¹ \ç¬”è®°\pictures\æ¥¼+æ·±åº¦å­¦ä¹ \NLP\åºåˆ—æ¨¡å‹åˆ†ç±»-è¾“å…¥è¾“å‡º.jpg)

- ä¸€å¯¹ä¸€æ¨¡å‹ï¼šæˆ‘ä»¬ä¹‹å‰çš„æ¨¡å‹ï¼Œæ¯”å¦‚å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼Œå°±æ˜¯ä¸€å¯¹ä¸€çš„ç»“æ„ã€‚æˆ‘ä»¬ç»™å®ƒä¸€ä¸ªè¾“å…¥ï¼Œå®ƒèƒ½å¾—åˆ°ä¸€ä¸ªè¾“å‡ºï¼Œè€Œä¸”ä¸åŒè¾“å…¥é—´è¢«è§†ä½œäº†ç‹¬ç«‹çš„å…³ç³»ï¼Œåˆ†åˆ«è¿›è¡Œå­¦ä¹ æˆ–è€…è¯†åˆ«ç­‰ä»»åŠ¡ã€‚è€Œç°åœ¨æˆ‘ä»¬è¦å…³æ³¨çš„ï¼Œæ˜¯åå››å¹…å›¾ï¼Œä¹Ÿå°±æ˜¯**æ—¶åºçš„æ¨¡å‹**ã€‚
- ä¸€å¯¹å¤šæ¨¡å‹ï¼šæ ¹æ®æ¨¡å‹çš„ä¸€ä¸ªè¾“å‡ºï¼Œå¯ä»¥ç”¨æ¥é¢„æµ‹ä¸€ä¸ªåºåˆ—ã€‚æ¯”å¦‚å¯¹äºä¸€ä¸ªå›¾åƒï¼Œè¾“å‡ºä¸€ä¸²å­—å¹•æ¥æè¿°å®ƒã€‚
- å¤šå¯¹ä¸€æ¨¡å‹ï¼šæ ¹æ®ä¸€ä¸ªåºåˆ—è¾“å…¥ï¼Œä»è€Œé¢„æµ‹ä¸€ä¸ªå€¼ã€‚æ¯”å¦‚æ ¹æ®ç”¨æˆ·åœ¨ä¸€å®¶é¥­åº—çš„ç•™è¨€ï¼Œåˆ¤æ–­ç”¨æˆ·å¯¹è¿™å®¶é¥­åº—çš„è¯„ä»·ã€‚é‚£ä¹ˆï¼Œè¾“å…¥æ˜¯ä¸€æ®µè¯æ˜¯ä¸€ä¸ªåºåˆ—è¾“å…¥ï¼Œè¾“å‡ºæ˜¯ 0 è‡³ 5 ä¹‹é—´çš„ä¸€ä¸ªæ•°ä½œä¸ºæ‰“åˆ†ã€‚
- **å¤šå¯¹å¤šæœ‰å»¶è¿Ÿ**ï¼šæ ¹æ®æ¨¡å‹çš„åºåˆ—è¾“å…¥ï¼Œæˆ‘ä»¬æ ¹æ®å·²æœ‰çš„è¾“å…¥ï¼Œ**æœ‰å»¶è¿Ÿåœ°è¾“å‡ºä¸€ä¸ªåºåˆ—**ã€‚å¸¸è§çš„ä»»åŠ¡æ¯”å¦‚ç¿»è¯‘çš„å­¦ä¹ ä»»åŠ¡ï¼Œè‹±æ–‡ç¿»è¯‘æˆä¸­æ–‡ã€‚æ¨¡å‹éœ€è¦ç­‰è‹±æ–‡è¾“å…¥åˆ°ä¸€å®šç¨‹åº¦åï¼Œæ‰èƒ½ç¿»è¯‘æˆä¸­æ–‡ï¼Œè¿™æ ·è¾“å…¥è¾“å‡ºéƒ½ä¸ºä¸€ä¸ªåºåˆ—ã€‚
- **å¤šå¯¹å¤šæ— å»¶è¿Ÿ**ï¼šæ ¹æ®æ¨¡å‹çš„åºåˆ—è¾“å…¥ï¼Œæ ¹æ®è¾“å…¥**åŒæ­¥è¾“å‡º**ä¸€ä¸ªåºåˆ—ã€‚å¸¸è§çš„æ¯”å¦‚åšå¤©æ°”é¢„æŠ¥ï¼Œéœ€è¦å®æ—¶æ ¹æ®æµ‹å¾—çš„æ¸©åº¦ã€æ¹¿åº¦ç­‰åšå‡ºä¸‹é›¨æ¦‚ç‡çš„é¢„æµ‹ã€‚ä½†æ˜¯ï¼Œæ¯ä¸€æ¬¡é¢„æµ‹å…¶å®ä¹Ÿè¦è€ƒè™‘ä¹‹å‰çš„ä¸€äº›åºåˆ—è¾“å…¥ï¼Œè€Œä¸ä»…ç”±è¿™ä¸€æ—¶åˆ»çš„è¾“å…¥æ‰€å†³å®šã€‚

åºåˆ—æ¨¡å‹çš„å…¸å‹ç‰¹ç‚¹æ˜¯**è¾“å…¥è¾“å‡ºä¸ç‹¬ç«‹**ï¼Œå¾€å¾€è¾“å‡ºè·Ÿå‰ä¸€æ­¥ã€ç”šè‡³å‰å‡ æ­¥çš„è¾“å…¥ç›¸å…³ã€‚

# ç®€å•RNN

å¾ªç¯ç¥ç»ç½‘ç»œçš„è§£å†³æ–¹æ³•ï¼Œæ˜¯é€šè¿‡è®©éšè—å±‚ä¸ä»…åªè€ƒè™‘ä¸Šä¸€å±‚çš„è¾“å‡ºï¼Œè¿˜åŒ…æ‹¬äº†**ä¸Šä¸€æ—¶åˆ»è¯¥éšè—å±‚çš„è¾“å‡º**ã€‚ç†è®ºä¸Šï¼Œå¾ªç¯ç¥ç»ç½‘ç»œèƒ½å¤ŸåŒ…å«**å‰é¢ä»»æ„å¤šä¸ªæ—¶åˆ»çš„çŠ¶æ€**ã€‚å®è·µä¸­ä¸ºäº†é™ä½æ¨¡å‹çš„å¤æ‚æ€§ï¼Œæˆ‘ä»¬ä¸€èˆ¬åªå¤„ç†å‰é¢å‡ ä¸ªçŠ¶æ€çš„è¾“å‡ºã€‚

ç›¸æ¯”äºä¼ ç»Ÿçš„å‰é¦ˆå¼ç¥ç»ç½‘ç»œï¼Œå¾ªç¯ç¥ç»ç½‘ç»œ**å°†ä¸åŒæ—¶åºçš„åŒä¸€å±‚å‰åè¿äº†èµ·æ¥**ï¼Œæƒå€¼ä¸Šå°±ä¼š**é€šè¿‡å¼•å…¥å¦ä¸€ä¸ªæƒå€¼**ï¼Œæ¥**å†³å®šä¸Šä¸€æ—¶åˆ»çš„è¾“å‡ºå¦‚ä½•ä½œä¸ºè¾“å…¥**ï¼Œå¹¶**å½±å“åˆ°ä¸‹ä¸€æ—¶åˆ»çš„è¾“å‡º**ã€‚

## åŸºæœ¬ç»“æ„

![](D:\äº‹åŠ¡\æˆ‘çš„äº‹åŠ¡\æ‹“å±•å­¦ä¹ \ç¬”è®°\pictures\æ¥¼+æ·±åº¦å­¦ä¹ \NLP\RNNåŸºæœ¬ç»“æ„.jpg)

å‰é¦ˆå¼ç¥ç»ç½‘ç»œçš„è¾“å…¥ ğ‘¥0â‹¯ğ‘¥ğ‘¡ æ˜¯ä¸€æ¬¡æ€§ä¼ å…¥çš„ï¼Œè€Œå¾ªç¯ç¥ç»ç½‘ç»œæ˜¯ ğ‘¥0 ä¼ å…¥åå¾—åˆ° â„0 ä¹‹åï¼Œå†è¿›è¡Œ ğ‘¥1 çš„è¾“å…¥ã€‚

- è¯¦ç»†å±•å¼€

![](D:\äº‹åŠ¡\æˆ‘çš„äº‹åŠ¡\æ‹“å±•å­¦ä¹ \ç¬”è®°\pictures\æ¥¼+æ·±åº¦å­¦ä¹ \NLP\RNNè¯¦ç»†å±•å¼€.jpg)

ä¸Šé¢çš„å…¬å¼ä¸­æ·»åŠ äº†æ¿€æ´»å‡½æ•°ï¼Œä¾‹å¦‚æˆ‘ä»¬æƒ³æ±‚å¾— â„2ï¼Œå®é™…ä¸Šç®€å•æ¥å†™ï¼š
$$
h_2 = l_1(x_1) + r_1(h_1) \tag{1}
$$

# LSTMé•¿çŸ­æœŸè®°å¿†æ¨¡å‹

> ç®€å•RNNæ— æ³•è§£å†³é•¿ä¾èµ–é—®é¢˜ã€‚
>
> ä¸ºæ­¤ï¼ŒRNNå¯ä»¥é€šè¿‡æ”¹å˜æ¨¡å—ï¼Œæ¥å¢å¼ºéšè—å±‚çš„åŠŸèƒ½ï¼Œ**`LSTM`** å’Œ **`GRU`** æœ€ä¸ºç»å…¸ã€‚

## å«ä¹‰

LSTM å…¨ç§°æ˜¯ [ *é•¿çŸ­æœŸè®°å¿†æ¨¡å‹*](https://zh.wikipedia.org/zh-hans/é•·çŸ­æœŸè¨˜æ†¶)ï¼Œæ˜¯ç›®å‰éå¸¸æµè¡Œçš„å¾ªç¯ç¥ç»ç½‘ç»œå…ƒç»“æ„ã€‚å®ƒä¸ä¸€èˆ¬çš„ RNN ç»“æ„æœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œåªæ˜¯ä½¿ç”¨äº†**ä¸åŒçš„å‡½æ•°å»è®¡ç®—éšè—å±‚çš„çŠ¶æ€**ã€‚

- é—¨ç»“æ„

1. é—å¿˜é—¨ã€‚
2. è¾“å…¥é—¨ã€‚
3. è¾“å‡ºé—¨ã€‚

è¿™é‡Œï¼Œæˆ‘ä»¬å†ä¸¾ä¸€ä¸ªæ›´å½¢è±¡çš„ä¾‹å­é‡æ–°æ¢³ç†ä¸€ä¸‹ LSTM ä¸åŒé—¨ç»“æ„çš„ä½œç”¨ã€‚ä¾‹å¦‚éœ€è¦è®­ç»ƒä¸€ä¸ªè¯­è¨€æ¨¡å‹ï¼ŒLSTM å•å…ƒçŠ¶æ€ä¸­éƒ½åº”è¯¥åŒ…å«å½“å‰ä¸»è¯­çš„æ€§åˆ«ä¿¡æ¯ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®é¢„æµ‹å¹¶ä½¿ç”¨äººç§°ä»£è¯ã€‚ä½†æ˜¯ï¼Œå½“è¯­å¥å¼€å§‹ä½¿ç”¨æ–°çš„ä¸»è¯­æ—¶ï¼Œé—å¿˜é—¨çš„ä½œç”¨å°±æ˜¯æŠŠä¸Šæ–‡ä¸­çš„ä¸»è¯­æ€§åˆ«ç»™å¿˜æ‰é¿å…å¯¹ä¸‹æ–‡é€ æˆå½±å“ã€‚æ¥ä¸‹æ¥ï¼Œè¾“å…¥é—¨å°±éœ€è¦æŠŠæ–°çš„ä¸»è¯­æ€§åˆ«ä¿¡æ¯ä¼ å…¥åˆ°å•å…ƒä¸­ã€‚

æœ€åï¼Œè¾“å‡ºé—¨çš„ä½œç”¨æ˜¯å¯¹æœ€ç»ˆè¾“å‡ºè¿›è¡Œè¿‡æ»¤ã€‚å‡è®¾æ¨¡å‹åˆšåˆšæ¥è§¦äº†ä¸€ä¸ªä»£è¯ï¼Œæ¥ä¸‹æ¥å¯èƒ½è¦è¾“å‡ºä¸€ä¸ªåŠ¨è¯ï¼Œè€Œè¿™å°±ä¸ä»£è¯çš„ä¿¡æ¯ç›¸å…³ã€‚æ¯”å¦‚è¿™ä¸ªåŠ¨è¯åº”è¯¥é‡‡ç”¨å•æ•°è¿˜æ˜¯å¤æ•°å½¢å¼ï¼Œè¿™å°±éœ€è¦æŠŠåˆšå­¦åˆ°çš„å’Œä»£è¯ç›¸å…³çš„ä¿¡æ¯éƒ½åŠ å…¥åˆ°å…ƒçŠ¶æ€ä¸­æ¥ï¼Œæ‰èƒ½å¾—åˆ°æ­£ç¡®çš„è¾“å‡ºã€‚

# åŒå‘RNN

> åœ¨ç»å…¸çš„å¾ªç¯ç¥ç»ç½‘ç»œä¸­ï¼ŒçŠ¶æ€çš„ä¼ è¾“æ˜¯**ä»å‰å¾€åå•å‘è¿›è¡Œ**çš„ã€‚ç„¶è€Œåœ¨æœ‰äº›é—®é¢˜ä¸­ï¼Œå½“å‰æ—¶åˆ»çš„è¾“å‡ºä¸ä»…å’Œä¹‹å‰çš„çŠ¶æ€æœ‰å…³ç³»ï¼Œä¹Ÿ**å’Œä¹‹åçš„çŠ¶æ€ç›¸å…³**ã€‚å°±æ¯”å¦‚æˆ‘ä»¬å¹³å¸¸çš„**ä¸­è‹±æ–‡ç¿»è¯‘**ï¼Œæˆ‘ä»¬æ ¹æ®å‰åæ–‡æ‰èƒ½è®©æˆ‘ä»¬çš„ç¿»è¯‘æ›´åŠ å‡†ç¡®ã€‚è¿™æ—¶å°±éœ€è¦åŒå‘ RNNï¼ˆBidirectional Recurrent Neural Networksï¼‰æ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚

åŸå§‹çš„åŒå‘ RNN æ˜¯ç”±ä¸¤ä¸ªç›¸å¯¹ç®€å•çš„ RNN ä¸Šä¸‹å åŠ åœ¨ä¸€èµ·ç»„æˆçš„ã€‚è¾“å‡ºç”±è¿™ä¸¤ä¸ª RNN çš„çŠ¶æ€å…±åŒå†³å®šã€‚

# æ·±åº¦RNN

æ·±åº¦ RNN åˆ™æ˜¯é€šè¿‡å åŠ å¤šä¸ª RNN ç½‘ç»œæ„å»ºæ›´å¤æ‚çš„æ¨¡å‹

# RNNæ­å»º

- è¯ç´¢å¼•

æ•°æ®é›†ä¸­çš„æ¯ä¸€æ¡è¯„è®ºéƒ½ç»è¿‡é¢„å¤„ç†ï¼Œå¹¶ç¼–ç ä¸ºè¯ç´¢å¼•ï¼ˆæ•´æ•°ï¼‰çš„åºåˆ—è¡¨ç¤ºã€‚è¯ç´¢å¼•çš„æ„æ€æ˜¯ï¼Œå°†è¯æŒ‰æ•°æ®é›†ä¸­å‡ºç°çš„é¢‘ç‡è¿›è¡Œç´¢å¼•ï¼Œä¾‹å¦‚æ•´æ•° 3 ç¼–ç äº†æ•°æ®ä¸­ç¬¬ä¸‰ä¸ªæœ€é¢‘ç¹çš„è¯ã€‚

- é¢„å¤„ç†

å¦‚æœä½ è¾“å‡ºå¤šæ¡è¯„è®ºåï¼Œä½ ä¼šå‘ç°æ¯æ¡è¯„è®ºçš„é•¿åº¦å¤§å°ä¸ä¸€ã€‚ä½†æ˜¯ç¥ç»ç½‘ç»œè¾“å…¥æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»ä¿è¯æ¯ä¸€æ¡æ•°æ®çš„å½¢çŠ¶æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ã€‚

è¿™é‡Œä½¿ç”¨ `tf.keras.preprocessing.sequence.pad_sequences()` è¿›è¡Œå¤„ç†ï¼Œé€šè¿‡æŒ‡å®šæœ€å¤§é•¿åº¦ `maxlen` è¾¾åˆ°è£åˆ‡å‘é‡çš„ç›®çš„ã€‚åŒæ—¶ï¼Œå¦‚æœåŸå¥å­é•¿åº¦ä¸è¶³ï¼Œå°†ä¼šåœ¨å¤´éƒ¨é€šè¿‡ 0 å¡«å……ã€‚

- è¯åµŒå…¥

è¯åµŒå…¥ï¼Œè‹±æ–‡å« Word Embeddingï¼Œè¿™æ˜¯ä¸€ç§ååˆ†å¸¸ç”¨çš„**è¯ç´¢å¼•ç‰¹å¾åŒ–æ‰‹æ®µ**ã€‚

å…³äº Embeddingï¼Œè¿™é‡Œä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ç”¨æ¥ç†è§£ã€‚ä¾‹å¦‚å•è¯ apple å¯¹åº”çš„è¯ç´¢å¼•ä¸º 100ã€‚é€šè¿‡ Embedding è½¬åŒ–åï¼Œ100 å°±å¯ä»¥å˜æˆä¸€ä¸ªæŒ‡å®šå¤§å°çš„å‘é‡ï¼Œæ¯”å¦‚è½¬åŒ–ä¸º [1,2,1][1,2,1]ã€‚å…¶ä¸­ï¼Œ1 è¡¨ç¤º apple æ˜¯ä¸ªå¾ˆè®¨äººå–œæ¬¢çš„ä¸œè¥¿ï¼Œ2 è¡¨ç¤º apple æ˜¯ä¸ªæ°´æœï¼Œæœ€åçš„ 1 è¡¨ç¤º apple æ˜¯æœ‰ç›Šèº«ä½“å¥åº·çš„ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªç‰¹å¾åŒ–çš„è¿‡ç¨‹ã€‚

```python
# IMDBæ•°æ®é›†
import numpy as np
import tensorflow as tf

# åŠ è½½æ•°æ®, num_words è¡¨ç¤ºåªè€ƒè™‘æœ€å¸¸ç”¨çš„ n ä¸ªè¯è¯­ï¼Œä»£è¡¨æœ¬æ¬¡æ‰€ç”¨è¯æ±‡è¡¨å¤§å°
MAX_DICT = 1000
(X_train, y_train), (X_test, y_test) = tf.keras.datasets.imdb.load_data(
    num_words=MAX_DICT)

# çœ‹åˆ°åŸè¯„è®ºå†…å®¹å°±éœ€è¦é€šè¿‡ç´¢å¼•ä»å­—å…¸ä¸­æ‰¾åˆ°åŸå•è¯
index = tf.keras.datasets.imdb.get_word_index()  # è·å–è¯ç´¢å¼•è¡¨
reverse_index = dict([(value, key) for (key, value) in index.items()])
comment = " ".join([reverse_index.get(i - 3, "#")
                    for i in X_train[0]])  # è¿˜åŸç¬¬ 1 æ¡è¯„è®º
'''
ä¸Šé¢çš„è¾“å‡ºè¯­å¥ä¸­ï¼Œéƒ¨åˆ†ç”¨ # ä»£æ›¿çš„è¯å³ä¸åŒ…å«åœ¨è¿™ 1000 å¸¸ç”¨è¯ä¹‹ä¸­ã€‚
'''

MAX_LEN = 200  # è®¾å®šå¥å­æœ€å¤§é•¿åº¦
X_train = tf.keras.preprocessing.sequence.pad_sequences(X_train, MAX_LEN)
X_test = tf.keras.preprocessing.sequence.pad_sequences(X_test, MAX_LEN)

# æœ‰äº† Embedding ç»“æ„ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­å»ºä¸€ä¸ªç®€å•çš„å…¨è¿æ¥ç½‘ç»œæ¥å®Œæˆè¯„è®ºæƒ…ç»ªåˆ†ç±»äº†ã€‚
model = tf.keras.Sequential()
model.add(tf.keras.layers.Embedding(MAX_DICT, 16, input_length=MAX_LEN))
model.add(tf.keras.layers.Flatten())
model.add(tf.keras.layers.Dense(1, activation='sigmoid'))

model.summary()
```



```python
'''
å¼€å§‹ä½¿ç”¨ Keras æ„å»ºé¡ºåºæ¨¡å‹ç»“æ„ï¼Œè¯¥å¾ªç¯ç¥ç»ç½‘ç»œåˆ†ä¸º 3 å±‚ï¼Œåˆ†åˆ«æ˜¯ Embeddingï¼ŒSimpleRNNï¼Œä»¥åŠç”¨äºè¾“å‡ºçš„ Dense å…¨è¿æ¥å±‚
'''
model_RNN = tf.keras.Sequential()
model_RNN.add(tf.keras.layers.Embedding(MAX_DICT, 32))
# dropout æ˜¯å±‚ä¸å±‚ä¹‹å‰çš„ dropout æ•°å€¼ï¼Œrecurrent_dropout æ˜¯ä¸Šä¸ªæ—¶åºä¸è¿™ä¸ªæ—¶åºçš„ dropout å€¼
model_RNN.add(tf.keras.layers.SimpleRNN(units=32,
                                        dropout=0.2,
                                        recurrent_dropout=0.2))
model_RNN.add(tf.keras.layers.Dense(1, activation='sigmoid'))
'''
model_RNN.suammry() å¯ä»¥å¸®æˆ‘ä»¬æ¸…æ™°åœ°çœ‹å‡ºæ¨¡å‹ç»“æ„ï¼Œæ¨¡å‹æ€»å…±è¦å­¦çš„å‚æ•°æ•°é‡è¾ƒå¤§ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹æ¨¡å‹è¿›è¡Œç¼–è¯‘å’Œè®­ç»ƒï¼Œå¹¶æœ€ç»ˆè¾“å‡ºæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„è¯„ä¼°æƒ…å†µã€‚
'''
model_RNN.compile(optimizer='Adam', loss='binary_crossentropy',
                  metrics=['accuracy'])
model_RNN.fit(X_train, y_train, BATCH_SIZE, EPOCHS,
              validation_data=(X_test, y_test))
```

```python
'''
ä¸‹é¢ï¼Œæˆ‘ä»¬æŠŠä¸Šé¢çš„ SimpleRNN ç»“æ„æ›´æ¢ä¸º LSTM ç»“æ„ï¼ŒTensorFlow ä¸­å¯ä»¥ç›´æ¥è°ƒç”¨ tf.keras.layers.LSTM  æ¥å®ç°ã€‚API å‚æ•°ä¸Šä¸ SimpleRNN è¿‘ä¹ç›¸åŒï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚
'''
model_LSTM = tf.keras.Sequential()
model_LSTM.add(tf.keras.layers.Embedding(MAX_DICT, 32))
model_LSTM.add(tf.keras.layers.LSTM(units=32,
                                    dropout=0.2,
                                    recurrent_dropout=0.2))
model_LSTM.add(tf.keras.layers.Dense(1, activation='sigmoid'))

model_LSTM.summary()

model_LSTM.compile(optimizer='Adam', loss='binary_crossentropy',
                   metrics=['accuracy'])
model_LSTM.fit(X_train, y_train, BATCH_SIZE, EPOCHS,
               validation_data=(X_test, y_test))
```



```python
model_GRU = tf.keras.Sequential()
model_GRU.add(tf.keras.layers.Embedding(MAX_DICT, 32))
model_GRU.add(tf.keras.layers.GRU(units=32,
                                  dropout=0.2,
                                  recurrent_dropout=0.2))
model_GRU.add(tf.keras.layers.Dense(1, activation='sigmoid'))

model_GRU.summary()

model_GRU.compile(optimizer='Adam', loss='binary_crossentropy',
                  metrics=['accuracy'])
model_GRU.fit(X_train, y_train, BATCH_SIZE, EPOCHS,
              validation_data=(X_test, y_test))
```

